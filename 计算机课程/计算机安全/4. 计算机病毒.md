---
tags:
---
---
# 恶意软件


**恶意程序定义**
恶意软件是指在未明确提示用户或未经用户许可的情况下，在用户计算机或其他终端上安装运行，侵害用户合法权益的软件， 但不包含我国法律法规规定的计算机病毒。

**恶意程序特征**
1. 强制安装： 指未明确提示用户或未经用户许可，在用户计算机或其他终端上安装软件的行为。
2. 难以卸载：指未提供通用的卸载方式，或在不受其他软件影响、人为破坏的情况下，卸载后仍然有活动程序的行为。
3. 浏览器劫持： 指未经用户许可， 修改用户浏览器或其他相关设置， 迫使用户访问特定网站或导致用户无法正常上网的行为。
4. 广告弹出：指未明确提示用户或未经用户许可，利用安装在用户计算机或 其他终端上的软件弹出广告的行为。
5. 恶意收集用户信息： 指未明确提示用户或未经用户许可，恶意收集用户信息的行为。
6. 恶意卸载： 指未明确提示用户、未经用户许可，或误导、欺骗用户卸载其他软件的行为。
7. 恶意捆绑： 指在软件中捆绑已被认定为恶意软件的行为。
8. 其他侵害用户软件安装、使用和卸载知情权、选择权的恶意行为。


**恶意软件分类**
-  Rootkit：隐藏其他程序进程的软件

---
# 计算机病毒
## 1. 基础

**计算机病毒定义**
- 广义定义
	- 能够引起计算机故障 , 破坏计算机数据的程序都统称为计算机病毒。
- 狭义定义
	- 病毒程序通过修改 ( 操作 ) 而传染其他程序 , 即修改其他程序使之含有病毒自身的精确版本或可能演化的版本、变种或其他病毒繁衍体
- 中国定义
	- 计算机病毒 , 指编制或者在计算机程序中插入的破坏计算机功能或者毁坏数据， 影响计算机使用，并能自我复制的一组计算机指令或者程序代码。
- 三个基本观点
	- 计算机病毒是人为制造的具有破坏性的程序。
	- 计算机病毒的运行是非授权入侵。
	- 计算机病毒可以隐藏在可执行文件或数据文件中。


---
## 2. 历史发展

**历史**
- 1983年第一个病毒, 伦·艾德勒曼 (Len  Adleman)将它命名为计算机病毒 (computer viruses)
- 1986年 Pakistan  巴基斯坦病毒，即 Brain
- 1988年 “蠕虫” 病毒
- CIH 病毒，又名“切尔诺贝利”, 破坏软件又破坏硬件的恶性病毒。
- 熊猫烧香
- 极虎病毒

**发展阶段**
- 第一阶段为原始病毒阶段, 1986 - 1989
- 第二阶段为**混合型病毒**阶段, 1989 - 1991
	- 计算机局域网开始应用与普及，许多单机应用软件开始转向网络环境
	- 第一次流行高峰
- 第三阶段为**多态性病毒**阶段, 1992 - 1995
	- 每次传染目标时，存入宿主程序中的病毒程序大部分是可变的, 同一种病毒存在多种样本.
- 第四阶段为**网络病毒**阶段, 1990 年代中后期. 
	- 随着国际互联网的发展壮大，依赖互联网络传播的邮件病毒和宏病毒等大量涌现，病毒传播快、隐蔽性强、破坏性大。
	- 也就是从这一阶段开始，反病毒产业开始萌芽并逐步形成一个规模宏大的新兴产业。
	- 这一时期病毒的最大特点是利用 Internet 作为其主要传播途径，病毒传播快、隐蔽性强、破坏性大。
- 第五阶段为**主动攻击型病毒**
	- 典型代表为 2003 年出现的“冲击波”病毒和 2004 年流行的“ 震荡波”病毒
	- 利用操作系统的漏洞进行进攻型的 扩散，并不需要任何媒介或操作，用户只要接入互联网络就有可能被感染
- 第六阶段为“ **手机病毒**” 阶段。
	- 随着移动通讯网络的 发展以及移动终端-手机功能的不断强大，计算机病毒开始从传统的互联网络走进移动通讯网络世界。

---
## 3. 分类

目前常见的病毒分类方法有 :

- 按传染方式分类: 分为引导型、可执行文件型、宏病毒和混合型病毒
	- 引导扇区病毒： 引导扇区病毒用它自己的数据来代管硬盘的原始引导扇区，并将病毒装入内存。

	- 文件感染病毒： 文件感染病毒将病毒代码加到可运行的程序文件中，在运行程序时即被激活。

	- 宏病毒：  利用宏语言编制的病毒，与前两种病毒存在很大的区别。宏病毒充分利用宏命令的强大系统调用功能，实现某些涉及系统底层操作的破坏。

	- 混合型病毒：混合型病毒是以上几种病毒的混合。混合型病毒的目的是为了综合利用以上 3 种病毒的传染渠道进行破坏。


- 按侵入的途径分类
	- 源码病毒：指病毒在源程序被编译前就被插入到源程序中。
	- 操作系统病毒：指病毒程序将自身加入或替代操作系统工作。
	- 入侵病毒：用自身代替正常程序中的部分模块或堆栈区。
	- 外壳病毒：将自身程序放在主程序的周围，一般不对原来的程序进行修改。


- 按破坏性分类
	计算机病毒的破坏情况可分两类.
	- 良性计算机病毒
		- 不会对系统的数据造成无法恢复破坏的病毒病毒一般称为良性病毒
		- 良性病毒是指那些只是为了表现自身 , 并不彻底破坏系统和数据 , 但会大量占用 CPU 时间 , 增加系统开销 , 降低系统工作效率的一类计算机病毒。
	- 恶性计算机病毒
		- 若受病毒攻击造成数据的丢失且不能恢复则称恶性病毒
		- 恶性病毒就是指在其代码中包含有损伤和破坏计算机系统的操作，在其传染或发作时会对系统产生直接的破坏作用，造成的损失是无法挽回的。


- 按照传播媒介分类
	- 单机病毒
		单机病毒的载体是磁盘，常见的是病毒 从移动存储设备（软盘、优盘）传入硬盘， 感染系统，然后再传染其他移动存储设备统。
	- 网络病毒
		网络病毒的传播媒介不再是移动式载体,而是网络通道，这种病毒的传染能力更强，破坏力更大。


---
## 4. 计算机病毒特征

1 ）计算机病毒的程序性 ( 寄生性 )
计算机病毒与其他合法程序一样，是一段可执行程序， 但它不是一个完整的程序，而是寄生在其他可执行程序上，因此计算机病毒具有正常程序的一切特性：可存储性、可执行性。它隐藏在合法的程序或数据中，当用户运行正常程序时，病毒伺机窃取到系统的控制权， 得以抢先运行，然而此时用户还认为在执行正常程序。

2 ）计算机病毒的传染性
传染性，指计算机病毒在一定条件下可以自我复制，能对其它文件或系统进行一系列非法操作，并使之成为一个新的传染源。这是病毒的最基本特征。

3 ） 计算机病毒的潜伏性
通常计算机病毒程序进入系统之后一般不会马上发作， 可以在几周或者几个月内甚至几年内隐藏在合法文件中， 对其他系统进行传染， 而不被人发现，潜伏性愈好，其在系统中的存在时间就会愈长， 病毒的传染范围就会愈大。

4 ）表现性和破坏性
指病毒在触发条件满足时，立即对计算机系统的文件、资源等运行进行干扰破坏；无论何种病毒程序一旦侵入系统都会对操作系统的运行造成不同程度的影响。病毒程序的副作用轻者降低系统工作效率， 重者导致系统崩溃、 数据丢失。病毒程序的表现性或破坏性体现了病毒设计者的真正意图。

5 ）可触发性
计算机病毒一般都有一个或者几个触发条件。满足其触 发条件或者激活病毒的传染机制 , 使之进行传染 ; 或者激活病毒的表现部分或破坏部分。触发的实质是一种条件的控制 , 病毒程序可以依据设计者的要求 , 在一定条件下实施攻击。这个条件可以是敲入特定字符 , 使用特定文件 ,  某个特定日期或特定时刻 , 或者是病毒内置的计数器达到 一定次数等。


---
## 5. 工作原理

计算机病毒实际上是一种特殊的程序，其组成与工作机理与一般程序的没有本质上的区别。所不同的是，病毒程序不像一般程序那样以单独文件形式存放在磁盘上，它**必须将自身寄生在其他程序上**.

- 计算机病毒组成
	- 病毒的初始化（引导）模块
	- 传染模块
	- 触发模块
	- 破坏（表现）模块

![[Pasted image 20240528102628.png]]


### 病毒的初始化 （引导）模块

**寄生**
- 寄生位置：
	- 引导区
	- 可执行文件
- 寄生手段：
	- 替代法（寄生在引导区中的病毒常用该法）
	- 链接法（寄生在文件中的病毒常用该法）


**引导过程**
1. 驻留内存
	病毒若要发挥其破坏作用，一般要驻留内存。为此就必须开辟所用内存空间或覆盖系统占用的部分内存空间。有的病毒不驻留内存。
1. 窃取系统控制权。
	在病毒程序驻留内存后，必须使有关部分取代或扩充系统的原有功能，并窃取系统的控制权。此后病毒程序依据其设计思想，隐蔽自己，等待时机，在条件成熟时，再进行传染和破坏。
1. 恢复系统功能
	病毒为隐蔽自己，驻留内存后还要恢复系统，使系统不会死机，只有这样才能等待时机成熟后，进行感染和破坏的目的。


**引导区病毒引导过程**
1. 搬迁系统引导程序，将原程序替代为病毒引导程序
2. 启动时，病毒引导模块→加载传染、破坏和触发模块到内存→使用常驻技术。
3. 最后，转向系统引导程序→引导系统


**文件型病毒引导过程**
1. 修改入口指令，替代为跳转到病毒模块的指令
2. 执行时，跳转到病毒引导模块→病毒引导模块→ 加载传染、破坏和触发模块到内存→ 使用常驻技术
3. 最后，转向程序的正常执行指令→执行程序

### 传染模块

- 传染条件
	- 被动传染（静态时）
		用户在进行拷贝磁盘或文件时，把一个病毒由一个载体复制到另一个载体上。或者是通过网络上的信息传递，把一个病毒程序从一方传递到另一方。这种传染方式叫做计算机病毒的被动传染。
	- 主动传染（动态时）
		以计算机系统的运行以及病毒程序处于激活状态为先决条件.在病毒处于激活的状态下，只要传染条件满足，病毒程序能主动地把病毒自身传染给另一个载体或另一个系统。这种传染方式叫做计算机病毒的主动传染。

- 传染过程
	系统（程序）运行 → 各种模块进入内存 → 按多种传染方式传染.

-  传染方式
	- 立即传染，即病毒在被执行的瞬间， 抢在宿主程序开始执行前，立即感染磁盘上的其他程序，然后再执行宿主程序。
	- 驻留内存并伺机传染，内存中的病毒检查当前系统环境，在执行一个程序、浏览一个网页时传染磁盘上的程序， 驻留在系统内存中的病毒程序在宿主程序运行结束后，仍可活动，直至关闭计算机。


**文件型病毒**

文件型病毒传染机理
- 首先根据病毒自己的特定标识来判断该文件是否已感染了该病毒；
- 当条件满足时，将病毒链接到文件的特定部位，并存入磁盘中；
- 完成传染后，继续监视系统的运行，试图寻找新的攻击目标。

文件型病毒传染途径
- 加载执行文件
- 浏览目录过程
- 创建文件过程


### 触发模块
- 触发条件
	计算机病毒在传染和发作之前，往往要判断某些特定条件是否满足，满足则传染或发作，否则不传染或不发作或只传染不发作，这个条件就是计算机病毒的触发条件。
- 触发模块的目的是调节病毒的攻击性和潜伏性之间的平衡

常用触发条件
1. 日期触发 : 许多病毒采用日期做触发条件，在特定的日期触发。
2. 时间触发：时间触发包括特定的时间触发、染毒后累计工作时间触发、文件最后写入时间触发等。
3. 键盘触发： 键盘触发包括击键次数触发、组合键触发、热启动触发等。
1. 启动触发：病毒对机器的启动次数计数，并将此值作为触发条件称为启动触发。
5. 访问磁盘次数触发： 病毒对磁盘 I/O访问的次数进行计数， 以预定次数做 触发条 件叫访问磁盘次数触发。
6. 调用中断功能触发： 病毒对中断调用次数计数，以预定次数做触发条件。
7. CPU 型号 / 主板型号触发： 病毒能识别运行环境的 CPU 型号 / 主板型号， 以预定CPU 型号 / 主板型号做触发条件，这种病毒的触发方式奇特罕见。

被计算机病毒使用的触发条件是多种多样的， 而且往往不只是使用上面所述 的某一个条件， 而是使用由多个条件组合起来的触发条件。


### 破坏 （表现）模块

破坏对象：系统数据区、文件、内存、系统运行速度、磁盘、 CMOS、主板和网络等。

破坏的程度可能会导致正常的程序无法运行，把计算机内的文件删除或受到不同程度的损坏。




---
# B-反病毒

- **四个方面**
	- 防毒
		采取安全措施预防病毒侵入计算机；
	- 查毒
		指通过一定的技术手段判定出计算机病毒，准确地报出病毒名称；
	- 解毒
		根据病毒类型对感染对象的修改，并按照病毒的感染特性所进行的恢复。但恢复过程不能破坏未被病毒修改的内容；
	- 免疫
		即通过技术手段是计算机预备病毒的抵抗能力，但目前还没有找到通用的免疫方法。
## 1. 防治

- 防毒具体手段
	- 安装杀毒软件
	- 经常更新操作系统补丁，警惕电脑异常
	- 不使用来历不明的软件，不打开来历不明的邮件，不看来历不明的图片 ，不点击不明的链接
	- 定时备份重要数据
	- 时刻保持警惕
	- 学习更多的电脑知识 


---
## 2. 检测

**检测技术**
- 手工检测
	- 手工检测是指通过一些软件工具（ DEBUG. 、 PCTOOLS 、 NU 、 SYSINFO 等）提供的功能进行病毒的检测。
	- 费时费力，但可以剖析新病毒，检测识别未知病毒，可以检测一些自动检测工具不认识的新病毒。
- 自动监测
	- 自动检测是指通过一些杀毒软件来检测一个系统或一个软盘是否有毒的方法。
	- 可以方便地检测大量的病毒
	- 自动检测工具只能识别已知病毒，而且自动检测工具的发展总是滞后于病毒的发展， 所以检测工具总是对相对数量的未知病毒不能识别。


**分类**
病毒静态时存储于磁盘中，激活时驻留在内存中
- 按照寄生场所分类
	- 对内存的检测
	- 对磁盘的检测

**检测的原理**
- 利用病毒特征代码串的**特征代码法**
	- 检测已知病毒的最简单、开销最小的方法。
	- 其原理是将所有病毒的病毒码加以剖析，并且将这些病毒独有的特征搜集在一个病毒码资料库中，检测时以扫描的方式将待检测程序与病毒库中的病毒特征码进行一一对比

- 利用文件内容校验的**校验和法**
	- 计算正常文件的内容“校验和”，将该校验和写入文件中或写入别的文件中保存。在文件使用过程中，定期地或每次使用文件前，检查文件现在内容算出的校验和与原来保存的校验和是否一致。
	- 校验和法对隐蔽性病毒无效
	- 应用方法
		1. 在检测病毒工具中纳入校验和法，对被查的对象文件计算其正常状态的校验和，将校验和值写入被查文件中或检测工具中，而后进行比较。
		2. 在应用程序中，放入校验和法自我检查功能，将文件正常状态的校验和写入文件本身中，每当应用程序启动时，比较现行校验和与原校验和值。实行应用程序的自检测。
		3. 将校验和检查程序常驻内存，每当应用程序开始运行时，自动比较检查应用程序内部或别的文件中预先保存的校验和。

- 利用病毒特有行为特征的**行为监测法**
	- 利用病毒的特有行为特征来监测病毒

- 用软件虚拟分析的**软件模拟法**
	- 它是一种软件分析器，用软件方法来模拟和分析程序的运行，以后演绎为虚拟机上进行的查毒，启发式查毒技术等。
	- 新型检测工具
		- 特征代码法检测病毒，如果发现隐蔽病毒或多态性病毒嫌疑时，启动软件模拟模块，监视病毒的运行，待病毒自身的密码译码以后，再运用特征代码法来识别病毒的种类。

- 比较被检测对象与原始备份的**比较法**
	- 比较法是用原始的或正常的文件与被检测的文件进行比较。比较法包括长度比较法、内容比较法、内存比较法、中断比较法等

- 利用病毒特性进行检测的**感染实验法**
	- 运行可疑系统中的程序后，再运行一些确切知道不带毒的正常程序，然后观察这些正常程序的长度和校验和，如果发现有的程序增长，或者校验和变化，就可断言系统中有病毒

- 运用**反汇编技术**分析法
	- 分类
		- 静态：反汇编程序将病毒代码打印成反汇编后的程序清单进行分析， 看病毒分成哪些模块，使用了哪些系统调用， 采用了哪些技巧，如何将病毒感染文件的过程翻转为清除病毒、修复文件的过程
		- 动态


---
## 3. 消除

三步走
- 清除内存中的病毒。
- 清除磁盘中的病毒。
- 病毒发作后的善后处理。

**清除引导区病毒**
- 覆盖型的引导区型病毒，预先准备好正常引导程序的备份。
- 对主引导区表信息应该特别注意，因为一旦分区表信息被破坏，要从硬盘中提取现有分区的状况并恢复分区表比较困难。
- 对于将引导扇区转储的引导区型病毒，只要将原引导扇区找出并回写。但在回写前要检查其有效性，不然也可能会造成破坏，使原本在带病毒的情况下尚能存取的硬盘，在清除了病毒之后反而找不到硬盘了。

**感染 com 型和 exe 型的文件型病毒**
可以被清除干净，因为病毒是在基本保持原文件功能的基础上进行传染的，既然文件的基本功能在染毒后也能实现，只是增加了副产品——依靠文件中增加的病毒代码运行的病毒，那么反病毒软件也可以仿照病毒的方法进行传染的逆过程——将增加的病毒代码清除出被感染文件，并保持其原有的功能。

**覆盖型的文件型病毒**
被覆盖型病毒感染的文件最好彻底删除，因为文件原有的部分代码已被病毒代码所取代且没有备份，从而无法恢复文件原有的功能


消除技术
- 人工清除法
	- 首先，用一张无病毒感染的 DOS 系统盘，关闭写保护，启动系统
	- 然后判断病毒感染对象。
		- 如果是分区感染，则恢复正常的分区表；
		- 如果是 Boot 区感染，则恢复 Boot  区；
		- 如果是可执行文件感染，则对该文件消毒；
	- 最后，回收资源，如修改文件分配表（ FAT ）、根目录区等。
- 自动清除法

## 4. 免疫


**免疫原理**
计算机病毒的传染模块一般包括传染条件判断和实施传染两个部分。在病毒被激活的状态下，病毒程序通过检测被攻击对象是否存在这种传染标识，决定是否对目标对象进行传染并添加传染标识。我们可以事先在程序中加入这种标识，这样病毒就不会感染加标识的程序了。

- 优点
	- 有效防止一种特定病毒的传染
- 缺点
	- 对于不设有感染标识的病毒不能达到免疫的目的。
	- 当出现这种病毒的变种不再使用这个免疫标识时， 或出现新病毒时， 免疫标志无法发挥作用。
	- 由于病毒的种类较多，又由于技术上的原因，不可能对一个对象加上各种病毒的免疫标识，这就使得该对象不能对所有的病毒具有免疫作用。
	- 容易引起反病毒软件误杀，由于大多数反病毒软件也是通过查找病毒标识来处理病毒的，这样加过标识的程序很容易被当作感染病毒的程序处理。

## 5. 反病毒技术发展历程

第一代反病毒技术采取单纯的病毒特征码来判断， 将病毒从带毒文件中消除掉。这种方法可以准确地清除病毒、 误报率低、可靠性高。后来病毒技术的发展，特别是加密和 变形技术的运用，使得这种简单的静态扫描方式失去了作用。

第二代反病毒技术采用静态广谱特征扫描方法来检测病毒，这种方式可以更多地检测出变形病毒， 但另一方面也带来了较高的误报率， 尤其是用这种不严格的特征判定方式去 清除病毒带来的风险性很大，容易造成文件和数据的破坏。 所以静态防病毒技术具有难以克服的缺陷。

第三代反病毒技术的主要特点是将静态扫描技术和动态仿真跟踪技术结合起来， 将查、杀病毒合二而一， 形成一个整体解决方案，全面实现防、查、杀等反病毒所必备的各种手段，以驻留内存方式防止病毒 的入侵， 凡是检测到的病毒都能清除，不会破坏文件和数据。

第四代反病毒技术则基于多位 CRC( 循环冗余校验 ) 校验和扫描机理，综合了启发式智能代码分析技术、动态数据还原技术（能查出隐蔽性极强的压缩加密文件中的病毒）、内存解毒技术和自身免疫技术等先进的计算机反病毒技术。它是一种已经形成且仍在不断发展完善的计算机反病毒整体解决方案，较好地改变了以前防病毒技术顾此失彼、此消彼长的状态。




## 6. 恶意软件防治

 **定义**
 恶意软件是指在未明确提示用户或未经用户许可的情况下，在用户计算机或其他终端上安装运行，侵害用户合法权益的软件， 但不包含我国法律法规规定的计算机病毒。

**特征**
1. 强制安装：指未明确提示用户或未经用户许可，在用户计算机或其他终端上安装软件的行为。
2. 难以卸载：指未提供通用的卸载方式，或在不受其他软件影响、人为破坏的情况下，卸载后仍然有活动程序的行为。
3. 浏览器劫持：指未经用户许可，修改用户浏览器或其他相关设置，迫使用户访问特定网站或导致用户无法正常上网的行为。
4. 广告弹出：指未明确提示用户或未经用户许可，利用安装在用户计算机或其他终端上的软件弹出广告的行为。
5. 恶意收集用户信息：指未明确提示用户或未经用户许可，恶意收集用户信息的行为。
6. 恶意卸载：指未明确提示用户、未经用户许可，或误导、欺骗用户卸载其他软件的行为。
7. 恶意捆绑：指在软件中捆绑已被认定为恶意软件的行为。
8. 其他侵害用户软件安装、使用和卸载知情权、选择权的恶意行为。

**分类**
1. 广告软件（ Adware ） 
2. 间谍软件 ( Spyware)
	在用户不知情的情况下，在其电脑上安装后门、收集用户信息的软件
3. 浏览器劫持（Browser Hijack）
	对用户的浏览 器进行篡改， 使用户的浏览器配置不正常， 被强行引导到商业网站
4. 行为记录软件（ Track Ware ）
	未经用户许可，窃取并分析用户隐私数据，记录用户电脑使用习惯、网络浏览习惯等个人行为的软件
5. 恶意共享软件 (Malicious Shareware)
	共享软件为了获取利益， 采用诱骗手段、试用陷阱等方式强迫用户注册， 或在软件体内捆绑各类恶意插件，未经允许即将其安装到用户机器里

**防范与清除**

- 防治主要方法
	- 安全政策：企事业需要有相应的政策防范恶意软件事件。这些政策应该作为额外的恶意软件防范措施的基础。
	- 警惕性计划：主要包括对恶意软件事件防范的指导。
	- 漏洞处置：恶意软件攻击操作系统，服务和应用程序的套路就是利用其漏洞。必须及时通过升级软件、打补丁等处理漏洞。
	- 威胁处置：通常借助处置恶意软件风险的安全工具：杀毒软件，间谍软件探测和删除工具，入侵防御系统 (IPS) ，防火墙和路由器。

- 清除
	- 手工清除
	- 借助专业清除软件



---
Author : orgaworl@outlook.com

