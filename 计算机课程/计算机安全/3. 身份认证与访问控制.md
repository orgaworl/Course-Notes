---
tags:
  - 计算机安全
---
---
## 3.1 身份认证
身份认证是指证实主体的真实身份与其所声称的身份是否相符的过程，即指计算机及网络系统确认操作者身份的过程。

在数字世界中，一切信息包括用户的身份信息都是用一组特定的数据来表示的，计算机只能识别用户的数字身份，所有对用户的授权也是针对用户数字身份的授权。   

身份认证定义：
>身份认证定义可以定义为，为了使某些授予许可权限的权威机构、组织和个人满意，而提供所要求的证明自己身份的过程。

**身份认证的三要素：**
- What you know 你知道什么,即用户所知道的内容-密码，生日，机密问题
- What you have 你有什么,即用户所拥有的内容-钥匙，IC卡，令牌，身份证
- What you are 你是什么,用户所拥有的特征-手型，指纹，眼纹，声纹，说话方式，行走方式
从身份认证的安全性上来探讨，越实现更高要素的系统，越能提供更高的安全


**身份认证协议：**
   身份认证协议涉及一个证明者P和验证者V, P要让验证者V相信“他是P”, 必须做到：
- P和V在诚实的情况下，P能让V成功的识别自己，即在协议完成时，V接受了P的身份。
- V不能重新使用自己与P识别过程中的信息伪装成P，向第三者B证明自己是 P。
- 除了P以外的第三者C以P的身份执行该协议，能让V相信C是P的概率可以忽略不计。（无仿冒者）

身份认证协议的**类型分类**：
1. 双向认证协议
	双向认证协议是使通信双方确认对方的身份然后交换会话密钥，适用于通信双方同时在线的情况，是最常用的协议。

2. 单向认证协议
	通信的一方认证另一方的身份，如服务器先要认证用户是否是这项服务的合法用户，但不需要向用户证明自己的身份。

3. 基于对称密钥的认证协议
	往往需要双方事先已经通过其他方式（比如电话、信函或传递等物理方法）拥有共同的密钥。

4. 基于公钥的认证协议
	基于公钥的认证协议的双方一般需要知道对方的公钥。公钥的获得相对于对称密钥要简便，比如通过CA认证中心获得对方的数字证书，这是基于公钥的认证协议的优势。但是，公钥的缺点是加解密速度慢、代价大，所以认证协议的最后， 双方要协商出一个对称密钥作为下一步通信的会话密钥。

### 1. 口令认证
#### 传统静态口令身份认证

**用户名-口令认证**

- 缺点:
	1. 口令存储与发送都是以明文方式进行的。用户每次访问系统时都要以明文方式输入口令，这时很容易泄密。
	
	2. 口令在传输过程中可能被截获。
	
	3. 系统中所有用户的口令以文件形式存储在认证方，攻击者可以利用系统中存在的漏洞获取系统的口令文件。
	
	4.  人们选择口令的原则往往与安全原则相违背。用户为了记忆的方便，往往采用相同的口令。而低安全级别系统的口令容易被攻击者获得，从而用来对高安全级别系统进行攻击。
	
	5. 只能进行单向认证，即系统可以认证用户，而用户无法对系统进行认证。攻击者可能伪装成系统骗取用户的口令。
	6. 口令太短，很容易用搜索 ( 穷举攻击 ) 方法找到口令 ( 比如自动取款机上的口令字只是 6 位十进制数 )。
 

- 加强口令安全的措施：
	1. 禁止使用缺省口令。
	2. 定期更换口令。
	3. 保持口令历史记录，使用户不能循环使用旧口令。
	4. 用口令破解程序测试口令。（弱/中/强）


- 攻击手段:
	- 网络数据流窃听
	- 认证信息截取/重放
		采用离线方式对口令密文实施字典攻击
	- 字典
	- 穷举
	- 窥探
	- 社工
	- 垃圾搜索


口令猜中概率公式：P=L•R/S
L ：口令生命周期  
R ：进攻者单位时间内猜测不同口令次数
S ：所有可能口令的数目。为降低猜中的概率：


- 建议
	1. 减少口令使用寿命， 即提高口令更换的频率 ;
	2. 降低进攻者单位时间内猜测尝试口令的次数 ;
	3. 增加可能口令的数目，即提高口令的字符个数。

**防御方法**

(1) 选择很难破译的加密算法, 让硬件解密商品不能发挥作用。

(2) 控制用户口令的强度 ( 长度、混合、大小写 ), 增加攻击者搜索的空间，使必须搜索的口令数目非常大。

(3) 掺杂口令salt

(4 ) 不要暴露账户是否存在的信息
例：打入一个用户名后，不论账户是否存在， 都在相同时间里要求输入口令。

(5) 限制口令尝试次数,降低猜测口令的速度。

(6) 系统中只保存口令的加密形式。

(7) 要求用户选择自己的口令，而且是比较好的口令。

**良好密码策略构成：**
- 至少 8 个字符长；
- 既有大写字母又有小写字母；
- 至少有一个非标准字符；
- 至少有一个数字；
- 口令的长度根据访问等级和信息系统处理国家秘密信息的密级规定。




#### 动态口令认证

一次性口令，就是一个口令在认证过程中只使用一次，下次认证时则更换使用另一个口令。

  动态口令应用的基本特征是，用户必须持有一个用于产生动态口令的设备，用设备产生动态口令后，交给应用系统，再由应用系统转交认证系统认证。

- 认证:
	- 挑战 / 响应认证
		对称密钥对随机串(challage)进行加密
		- 优点：
			- 没有同步的问题。
			- 网络上传输的是加密信息, 安全性较高。
		- 缺点：
			- 使用者必须按较多的按钮，操作较繁复。
			- 比较多输入的失误。
	- 时间 / 同步认证
		对称密钥对时间(段)进行加密并比较
		- 优点：
			易于使用。
		- 缺点：
			1. 时间同步困难，可能造成必须重新输入新密码。软体认证卡采用PC的时刻，很可能随时被修改。常常需要与服务器重新对时。
			2. 不如挑战 / 响应认证安全

	- 事件 / 同步认证
		事件同步认证卡依据认证卡上的私有密钥产生一序列的动态密码， 如果使用者意外多产生了几组密码造成不同步的状态，服务器会自动重新同步到目前使用的密码，一旦一个密码被使用过后，在密码序列中所有这个密码之前的密码都会失效

动态口令认证系统一般由三个部份组成：

1. 动态口令令牌：  硬件设备，像一个小的计算器，  用来生成口令，可以随身携带。

2. 动态口令认证服务器：认证服务器端是动态口令认证系统的核心，负责响应认证系统客户端所发过来的用户认证请求(动态口令)，完成用户的身份认证。

3. 代理软件(Agent)： Agent (代理软件)以及基于各种标准的访问协议(如RADI US协议)构成认证转发点, 安装在受保护的系统上，负责将用户的认证请求转发到认证服务器端


动态口令认证总结:
- 动态性：口令每分钟变化， 不同时刻只能使用不同口令。
- 随机性：动态口令随机产生，不可预测。
- 一次性：口令使用一次后失效，防止重放。
- 方便性：随身携带，无需记忆，防止遗忘； 及时发现危险：及时发现丢失，挂失。
- 抗拒穷举攻击；
- 不可复制性；
- 双因素：与静态口令结合。

### 2. 基于 USB Key 的身份认证

USB Key 是一种 USB  接口的、小巧的硬件设备，它内置了 CPU 、存储器、芯片操作系统（COS），可以存储用户的密钥或数字证书，利用USB Key 内置的密码算法实现对用户身份的认证。 USB KEY 结合了现代密码学技术、智能卡技术和 USB 技术，是新一代身份认证产品。

特点:
1. 双因子认证
	每一个 USB Key 都具有硬件 PIN 码保护，PIN 码和硬件构成了用户使用 USB   Key 的两个必要因素，即所谓“ 双因子认证”。用户只有同时取得了 USB Key 和用户 PIN 码， 才可以登录系统。 

2. 带有安全存储空间
	USB  Key 具有 8K- 128K 的安全数据存储空间， 可以存储 数字证书、用户密钥等秘密数据。
	
3. 硬件实现加密算法
	USB Key内置 CPU 或智能卡芯片，可以实现 PKI 体系中使用的数据摘要、数据加解密和签名的各种算法， 加解密运算在 USB Key 内进行，保证了用户密钥不会出现在计算机内存中，从而杜绝了用户密钥被黑客截取的可能性。

4. 便于携带，安全可靠
	如拇指般大的 USB Key 非常方便随身携带，并且密钥和证书不可导出，Key的硬件不可复制， 更显安全可靠。

身份认证实现模式:

1. 基于冲击 - 响应认证模式
2. 基于数字证书的认证方式



### 3. 生物认证

- 采集特征满足性质:
	1. 普遍性：即每个人都应该具有这一特征。
	2. 唯一性：即每个人在这一特征上有不同的表现。
	3. 稳定性：即这一特征不会随着年龄的增长、时间的改变而改变。
	4. 易采集性：即这一特征应该是容易测量的。
	5. 可接受性：即人们是否接受这种生物识别方式。

- 常见认证形式
	- 指纹识别
		- 优点
			- 研究历史较长，技术相对成熟；
			- 指纹图像提取设备小巧；
			- 同类产品中， 指纹识别的成本较低。
		
		- 缺点表现在：
			- 指纹识别是物理接触式的，具有侵犯性；
			- 指纹易磨损，手指太干或太湿都不易提取图像。
	
	- 掌纹识别
	
	- 面部识别
	
	- 虹膜识别
	
	- 基于行为特征的生物识别技术


---
## 3.2 访问控制-实现机制
### 1. 实现机制
- 基于访问控制属性
	- 访问控制表 / 矩阵
- 基于用户和资源分级（“安全标签”）
	- 多级访问控制

### 2. 常见实现

- 能力关系表CL: 从主体出发
	容易获得一个主体所被授权可以访问的客体及其权限
	但要从客体出发获得哪些主体可以访问它困难.
- 访问控制表ACL: 从客体出发
	易查出对某一特定资源拥有访问权的所有用户，有效地实施授权管理，是目前采用的最多的一种实现形式 .

- 两者对比
	浏览访问权限： ACL: 容易， CL : 困难
	访问权限传递： ACL: 困难， CL : 容易
	访问权限回收： ACL: 容易， CL : 困难
	
- 授权关系表ARL
	描述了主体和客体之间各种授权关系的组合

### 3. 实现原则

1. 最小特权原则： 指“ 应限定网络中每个主体所必须的最小特权，确保可能的事故、错误、网络部件的篡改等原因造成的损失最小”。
2. 多人负责原则： 即授权分散化， 对于关键的任务必须在功能上进行划分，由多人来共同承担， 保证没有任何个人具有完成任务的全部授权或信息。
3. 职责分离原则：不同的责任分派给不同的人员以期达到相互牵制， 消除一个人执行两项不相容工作的风险



---
## 3.3 访问控制-控制原则

DAC 有利于信息共享， 适于大规模应用；

MAC 有利于信息保密， 适于专用或简单系统应用

DAC和MAC不足：
1. 自主式太弱
2. 强制式太强
3. 二者工作量大，不便管理



### 1) 自主访问控制DAC
在其拥有的资源范围内，所有者可以自主地直接或间接地将权限传给（分发给）主体.
- 特点：授权的实施主体自主负责赋予和回收其它主体对客体资源的访问权限。
- 优点：应用灵活。
- 缺点：信息在移动过程中其访问权限关系会被改变。
- 分类
	- 基于行的自主访问控制 ( 基于主体 )
	- 基于列的自主访问控制 ( 基于客体 )

#### 基于行的自主访问控制
在每个主体上都附加一个该主体可访问的客体的明细表。

1. 权限字（能力）
	权限字是一个提供给主体访问客体的特定权限的不可伪造标志（能力）。只有当一个主体对某个客体拥有准许访问的能力时， 它才能访问这个客体。
2. 前缀表 ( prefixes)
	前缀表包含受保护的文件名（客体名）及主体对它的访问权限。
3. 口令字

**能力关系表CL**是最常用的基于行的自主访问控制，决定主体是否可以访问客体以及以什么方式访问客体


#### 基于列的自主访问控制
给客体附加一份可访问它的主体的明细表。基于列的访问控制可以有两种方式
1. 保护位： 保护位方式不能完备地表达访问控制矩阵。保护位对所有的主体、主体组（ 用户、用户组）以及该客体（文件）的拥有者， 规定了一个访问模式的集合。

2. 存取控制表：访问控制表是目前采用最多的一种实现方式。 ACL 可以对某个特定资源指定任意一个用户的访问权限，还可以将有相同权限的用户分组，并授权组的访问权限。

基于访问控制矩阵中列的自主访问控制，在一个客体上附加一个主题明晰表， 来表示各个主体对这个客体的访问权限。

### 2) 强制访问控制MAC
为主体及客体指定敏感标记，这些标记是等级分类和非等级类别的组合，它们是实施强制访问控制的依据。系统通过比较主体和客体的敏感标记来决定一个主体是否能够访问某个客体。

**划分等级** T>S>C>U
- 最高秘密级（ Top  Secret ）
- 秘密级（ Secret ）
- 机密级（ Confidential ） 
- 无级别级（ Unclassified ）

**访问模式**:  
上/下 + 读/写

#### Bell- La Padula(BLP) 模型
多级安全模型

特点：维护系统的保密性，有效地防止信息泄漏。可防止低级用户和进程访问安全界别比他们高的信源。

该模型缺少完成性约束， 如信息的非授权修改、越权篡改等。

**偏序关系**
1. 当且仅当 SC(s) >=SC(o) ， 准许读操作。 
2. 当且仅当 SC(s) <=SC(o) ，准许写操作。

Bell-Lapadula 安全模型保证**数据的保密性**
- 不上读
- 不下写

强制访问安全策略：
对给定安全级别的主体，仅准许对相同安全级别或较低 安全级别的客体进行“读”；
对给定安全级别的主体，仅准许向相同安全级别或较高 安全级别的客体进行“写”。
#### Biba 模型
Biba 模型定义了完整性级别；
在信息流向的定义方面不准许从低级进程流向高级进程；
用户只能向比自己安全级别低的客体写入信息，而防止非法用户创建安全级别高的客体信息， 避免越权、 篡权行为的产生。

**关系表示：**
1. 当且仅当 SC(s) <=SC(o) ，准许读操作。
2. 当且仅当 SC(s) >=SC(o) ，准许写操作。

保证**数据完整性**
- 禁止向上写
- 没有向下读



### 3) 基于角色的访问控制RBAC
安全管理人员根据需要定义各种角色，并设置合适的访问权限，而用户根据其责任和资历再被指派为不同的角色. 即访问权限与角色相关联，角色再与用户关联，从而实现了用户与访问权限的逻辑分离.

![[Pasted image 20240624164059.png]]


**模型组成**
- 实体 (U, R, P)
	- 用户集 : 通常指主体，一般指人， USERS 表示用户集。
	- 角色集 : 角色是指一个组织或任务中的工作或位置，它代表了一种资格、权利和责任。用 ROLES 表示一个角色集合。
	- 权限：对客体的访问许可，用 PERMISSION 表示。
- 权限配置：ROLES 与 PERMISSION 之间的二元关系， (r,p) 表示 r 拥有一个权限。
- 用户的授权：USERS 与 ROLES 之间的二元关系， (u,r) 表示用户 u 被委派了一个角色 r ，用户与角色是多对多的。

**角色管理**
- 角色继承
	角色分层把角色组织起来，能够很自然地反映组织内部人员之间的职权、责任关系。层次之间存在高对低的继承关系，父角色可以继承子角色的许可,上一级拥有下一级的全部权限.
- 角色分配与授权
	- 角色 r 授权给一个用户 u的方式：
		- 角色 r 分配给用户 u 
		- 角色 r 通过一个分配给用户 u  的角色继承而来。
	- “用户/角色授权表” 记录了用户通过 “用户/角色分配表” 以及角色继承而取得的所有角色。可用性为真时， 用户才真正可以使用该角色赋予的许可。
- 角色限制
	- 角色互斥：
		同一用户只能分配到一组互斥角色集合中至多一个角色，支持责任分离的原则。互斥角色是指各自权限互相制约的两个角色。对于这类角色一个用户在某一次活动中只能被分配其中的一个角色，不能同时获得两个角色的使用权。
		- 静态互斥：只有当一个角色与所属的其他角色彼此不互斥时，这个角色才授权给该用户。
		- 动态互斥：只有当一个角色与主体中任何一 个当前活跃角色彼此不互斥时， 这个角色才能成为该主体一个活跃角色。
	- 角色基数限制： 创建角色是要指定角色基数. 一个角色被分配的用户数量受限；一个用户可拥有的角色数目受限；同样一个角色对应的访问权限数目也应受限

![[bbea5c50ca2783034193a5acd9fc663.png|625]]


**RBAC 描述复杂的安全策略**
1. 通过角色定义、分配和设置适应安全策略
	系统管理员定义系统中的各种角色， 每种角色可以完成一定的职能，不同的用户根据其职能和责任被赋予相应的角色，一旦某个用户成为某角色的成员，则此用户可以完成该角色所具有的职能。根据组织的安全策略特定的岗位定义为特定的角色、特定的角色授权给特定的用户。

1. 通过角色分层映射组织结构
	组织结构中通常存在一种上、下级关系，上一级拥有下一级的全部权限，为此， RBAC 引入了角色分层的概念。角色分层把角色组织起来，能够很自然地反映组织内部人员之间的职权、责任关系。层次之间存在高对低的继承关系，即父角色可以继承子角色的许可。
	
4. 容易实现最小特权原则
	使用 RBAC 能够容易地实现最小特权原则。在 RBAC 中，系统管理员可以根据组织内的规章制度、职员的分工等设计拥有不同权限的角色，只有角色需要执行的操作才授权给角色。当一个主体要访问某资源时 , 如果该操作不在主体当前活跃角色的授权操作之内， 该访问将被拒绝

4. 能够满足职责分离原则
	这是保障安全的一个基本原则，是指有些许可不能同时被同一用户获得，以避免安全上的漏洞。例如收款员、出纳员、审计员应由不同的用户担任。在 RBAC 中，职责分离可以有静态和动态两种实现方式。


**RBAC 系统结构**
RBAC 系统结构由 RBAC 数据库、身份认证模块、系统管理模块、会话管理模块组成。
身份认证模块通过用户标识、用户口令确认用户身份。此模块仅使用 RBAC 数据库的 USERS 表。

![[Pasted image 20240624164945.png|600]]


**RBAC 系统的运行步骤**
1. 用户登录时向身份认证模块发送用户标识、用户口令，确证用户身份；

2. 会话管理模块从 RBAC 数据库检索该用户的授权角色集并送回用户；

3. 用户从中选择本次会话的活跃角色集， 在此过程中会话管理模块维持动态角色互斥；
4. 会话创建成功， 本次会话的授权许可体现在菜单与按扭上，如不可用显示为灰色；
5. 在会话过程中，系统管理员若要更改角色或许可，可在此会话结束后进行或终止此会话立即进行。



---
Author : orgaworl@outlook.com