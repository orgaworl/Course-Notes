# 软件安全基础

---


## 软件缺陷&漏洞

**软件缺陷**
指计算机软件或者程序中存在的某种破坏正常运行能力的问题、错误或者隐藏的功能缺陷。缺陷的存在会导致软件产品在某种程度上不能满足用户的需要。

**软件漏洞**
指在硬件、软件、协议的具体实现或者系统的安全策略存 在缺陷，从而可以使得攻击者能够在未授权的情况下访问 或者破坏系统。


基本概念
- 软件缺陷 defect
	- Flaw 设计层面的缺陷
	- Bug  实现层面的缺陷
- 漏洞vulnerability  (安全方面的缺陷)
- 漏洞利用 exploit
	- shellcode
	- payload
导致的危害
- 软件正常功能被破坏
	软件崩溃、拒绝服务
- 系统被恶意控制、信息泄露、提权 
	攻击者通过精心设计构造攻击程序（Exploit），可以准确地触发软件漏洞，并利用软件漏洞在目标系统中插入 并执行精心设计的代码（shellcode/payload）从而获得 对目标系统的控制权。

### 缓冲区溢出
shellcode就是在利用溢出攻击溢出时要植入的代码,也就是溢出后去执行的代码

### 整数溢出


### 竞争条件
Linux内核的内存子系统在处理copy-on- write（COW）时出现竞争条件，导致私有只读存储器映射被破坏，可利用此漏洞非法获得读写权限，进而提升权限


## 恶意软件

软件以非预期方式工作

主要分类
- 计算机病毒
- 特洛伊木马
- 后门
- 僵尸
- 间谍软件
- 勒索软件

主要危害
- 修改或者破坏已有的软件功能 
- 目标系统中的重要数据被窃取 
- 目标系统中的用户行为被监视 
	- 对目标系统进行屏幕监视、视频监视、语音监视等。 
- 控制目标系统   木马、僵尸网络

防护措施
- OS访问控制
- 防火墙与入侵检测系统IDS
- 防病毒程序

### 病毒





### 木马
通过特定的程序（ 木马程序）来控制另一台计算机。

组成：
- 木马配置程序
- 控制端程序 （客户端）
- 木马程序（服务端/被控端）

![[Pasted image 20240709212543.png|500]]
**植入方式**
- 伪装欺骗植入
	- 更改后缀名、图标伪装成合法程序 
- 捆绑植入 
	- Exe捆绑、文档嵌入、多媒体文件、电子书植入 
- 其他
	-  社会工程，用户习惯

**木马连接方式**
- 获取连接信息：
	- 服务端通知客户端自身的IP地址、端口等信息、第三方控件信息
	- 服务端不主动通知，则客户端主动扫描
- 建立通信连接：选择可靠的、面向连接的传输层通信协议TCP 
	- 正向连接：控制端主动连接被控端
	- 反向连接

正向连接1
- 优点
	- 攻击者无需外部IP地址
	- 木马样本不会泄露攻击者IP地址
- 缺点 
	- 可能被防火墙阻挡 
	- 被攻击者必须具备外部IP地址 
	- 定位被攻击者相对困难 
	- 目标IP经常变化 
	- 目标主机何时上线

反向连接1：服务端连接到客户端
![[Pasted image 20240709221300.png|525]]
- 优点：
	- 通过防火墙相对容易
	- 攻击目标随时上线随时控制
	- 可以控制局域网内的目标
- 缺点：
	- 样本会暴露控制服务器信息
	- 攻击者通常应当具备外部IP的服务器

反向连接2：被控端和控制端都和第三方通信
![[Pasted image 20240709214253.png|525]]
优点
- 绕过防火墙，自动连接上线，不易被发现（代理）

### 后门
允许攻击者绕过系统中常规安全控制机制的程序，他按照攻击者自己的意图提供通道。



### Rootkit
Rootkit实现隐藏，只是采取一定的措施，使系统“ 看不到”相应的对象

演化过程
- 第一代Rootkit简单地替换或修改受害者系统上关键的系统文件
- 第二代的Rootkit大体上基于挂钩技术——通过对已加载的应用程序和一些诸如系统调用表的操作系统部件打内存补丁而改变执行路径
- 第三代Rootkit技术称为直接内核对象操作，其动态修改内核的数据结构，可逃过安全软件的检测
### 勒索病毒




---
## 软件破解
即通过对软件自身程序进行逆向分析，剖析软件的注册机制，对软件的各类限制实施破解，从而使得非法使用者可以正常使用软件
### 程序加壳技术


通过一系列数学运算，将可执行程序文件或动态链接库文件进行编码，以达到缩小文件体积或加密程序编码的目的。
将一个可执行文件转换创建一个新的可执行文件，**包含**
- 头部
- 脱壳存根（stub）供操作系统调用
- 数据（被转换后的可执行文件）

**加壳程序特征**
1. 当使用IDA Pro打开程序时，通过自动分析，只有少量代码被识别 
2. 当使用OllyDbg打开程序时，会有程序可能被加壳的警告 
3. 程序的节名中包含某款加壳器的标识 （如UPX0）。 
4. 程序拥有不正常的节大小，例如.text 节的原始数据大小为0，但虚拟大小 非零。 
5. 程序中导入函数很少，导入函数仅有 LoadLibrary和GetProcAddress时， 应该引起特别注意

**常见加壳器及分类**： 
- 压缩壳：upx ，aspack ，fsg ，pecompach
- 加密壳：ASProtect ，Armadillo(穿山甲)， EXEcryptor，Themida，ZProtect
- 虚拟机壳：VMProtect

### 程序脱壳技术

自动脱壳方法 
自动静态脱壳程序解压缩或者解密一个可执行文件，仅仅针对特定壳，并且对那些用来阻碍分析的壳无效。 自动的动态脱壳程序运行可执行文件，并让脱壳存根脱出原始的可 执行文件。一旦原始的可执行文件被脱壳，它将被写入硬盘，然后脱 壳程序重构原始的导入表。

